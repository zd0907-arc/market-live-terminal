### 1. 核心交互设计：统一的“多源对比”架构
这一套设计将贯穿“实时”和“历史”两个页面，逻辑完全一致，降低学习成本。

*   **默认状态 (Single View)**:
    *   页面右上角有一个 **“数据源”下拉框**（例如默认显示 `🟢 腾讯`）。
    *   旁边有一个 **“⚖️ 对比”开关**。
    *   此时页面全屏展示默认数据源的内容。

*   **对比状态 (Split View)**:
    *   当你点击“⚖️ 对比”后，页面瞬间**一分为二**（左右分屏）。
    *   **左侧**: 保持原有的默认数据源（如 `腾讯`）。
    *   **右侧**: 出现一个新的面板，顶部也有一个**“数据源”下拉框**，默认自动选择上次使用过的对比源（如 `东方财富` 或 `本地自算`）。
    *   **联动**: 左右两侧的图表（十字光标、缩放）保持联动，方便你一眼看出数据差异。

### 2. 实时页面 (Realtime) 的应用
*   **左侧源**: **腾讯 (Tencent)** —— 也就是目前的默认源，速度快。
*   **右侧源 (可选)**: **东方财富 (Eastmoney)**。
    *   我将在后端增加东财的实时快照接口作为备选。
    *   **场景**: 当你怀疑腾讯数据卡顿时，一键开启对比，看东财是不是也卡了，或者两者价格是否有细微偏差。

### 3. 历史页面 (History) 的应用
*   **左侧源**: **新浪 (Sina)** —— 官方算法，包含 r0/r1/r2/r3 资金流。
*   **右侧源 (可选)**: **本地自算 (Local)**。
    *   这是基于你本地积累的逐笔数据，结合**“自定义规则”**算出来的。
    *   **场景**: 你觉得新浪的“超大单”门槛太低（比如只有 100万），你想看如果门槛设为 500万，主力资金线会怎么走？此时开启对比，左边是新浪标准版，右边是你独家定制版，真相一目了然。

### 4. 支撑系统：本地数据工厂
为了支撑右边的“本地自算”源，后端需要构建一个强大的数据加工厂：
*   **原料**: 每天盘中自动采集并存储在 SQLite 中的海量逐笔数据 (`trade_ticks`)。
*   **加工**: 每天收盘后（或手动触发），根据你配置的参数（如 `超大单 > 500万`），重新遍历当天的所有成交，计算出新的资金流向数据。
*   **配置中心**: 前端增加一个“主力规则设置”弹窗，让你随时调整参数，调整后甚至可以重新计算过去的历史数据。

### 5. 实施路线图
1.  **后端升级**:
    -   实现 `Aggregation Engine` (聚合引擎)，负责把 Tick 变成 Daily History。
    -   接入 `Eastmoney` 实时源备用。
2.  **前端重构**:
    -   封装通用的 `DataSourceControl` 组件（含下拉框和对比开关）。
    -   改造主布局，支持 `Grid` 左右分屏模式。
    -   开发“规则设置”弹窗。

这套方案完美实现了你要求的“日常单屏高效盯盘，关键时刻双屏精准决策”的专业需求。准备好动工了吗？
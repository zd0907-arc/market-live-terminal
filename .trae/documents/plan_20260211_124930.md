### 1. 历史数据修复 (Critical)
**问题定位**: 前后端数据格式不匹配。
后端现在统一返回 `{ code: 200, data: [...] }` 结构，但前端 `StockService.ts` 还在按旧逻辑处理新浪数据（直接当做数组），导致前端拿到了一个对象而不是数组，渲染崩溃。
**修复方案**: 修改 `StockService.ts` 中的 `fetchHistoryAnalysis` 方法，无论 source 是 'sina' 还是 'local'，都统一从 `json.data` 中提取数组。

### 2. 界面精简与归位 (UI/UX)
**问题定位**:
1.  **多余的切换按钮**: 搜索框左侧（或 Logo 旁）可能还残留了一个“实时/历史”切换按钮，需要彻底删除。
2.  **数据源控件位置**: 目前可能还在 Card 外部或位置不准确。
**修复方案**:
1.  在 `App.tsx` 中彻底移除除了 Header 之外的所有 `View Mode` 切换代码。
2.  将 `DataSourceControl` 移动到图表容器（Card）的 **Header 区域内部**（右上角），与图表标题对齐。

### 3. 实时盘中状态 (Empty State)
**问题定位**: 需要确保在非交易时间（且无实时数据时）显示友好的提示。
**修复方案**: 检查 `isTradingHours` 逻辑，确保它能正确覆盖 A 股交易时段 (9:30-11:30, 13:00-15:00)，并在图表无数据时展示“休市/盘前”占位图。

准备好执行修复了吗？这次一定解决所有遗留问题！
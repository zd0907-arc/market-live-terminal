# V3.0 “微观听诊器” (Micro-Stethoscope) 严格执行方案

## 1. 核心纠偏
之前的实现虽然有了数据，但 **布局结构** 没有严格遵循您的“三层垂直贯穿”设计。现在的修正目标是完全复刻您的设计文档。

## 2. 详细设计 (Pixel-Perfect)

### 容器布局 (Right Panel Container)
*   **宽度**: 60px。
*   **高度**: 100% (h-full)，垂直贯穿整个模块。
*   **结构**: Flex-Column，分为上(Flex-1)、中(Flex-2)、下(Flex-1) 三部分。

### A. 顶层 (Top Layer): 瞬时价格与动能
*   **高度占比**: 约 25%。
*   **内容**: 大字号价格 (`23.75`)。
*   **动能特效**:
    *   比较 `usePrevious(price)`。
    *   涨 -> 背景瞬间变红 (`bg-red-500/30`) 然后淡出。
    *   跌 -> 背景瞬间变绿 (`bg-green-500/30`) 然后淡出。
    *   实现方式: CSS Animation `flash-red`, `flash-green`。

### B. 中层 (Middle Layer): 多空对峙条 (Bid-Ask Ratio)
*   **高度占比**: 约 50% (核心视觉区)。
*   **UI 组件**:
    *   **顶部数值**: 绿色小字 `压:5000`。
    *   **进度条**: 垂直细条 (w-1.5)，圆角。
        *   上段 (Ask): 绿色背景，高度 = `Ask / (Ask+Bid)`。
        *   下段 (Bid): 红色背景，高度 = `Bid / (Ask+Bid)`。
        *   **游标**: 白色细线 (`h-[1px] w-full bg-white absolute`) 定位在分界处。
    *   **底部数值**: 红色小字 `托:2000`。
*   **布局**: Flex-Column 居中对齐。

### C. 底层 (Bottom Layer): Tick 速度
*   **高度占比**: 约 25%。
*   **内容**:
    *   标签: `Tick` (灰色)。
    *   数值: `85` (白色)。
    *   **高亮**: 若 `tick_vol > 1000`，数值变黄并加闪电图标 `⚡️`。

## 3. 实施步骤

### Step 1: 准备 CSS 动画
在 `SentimentTrend.tsx` 中添加 `flash-red` 和 `flash-green` 的 Keyframes。

### Step 2: 重构右侧 JSX 结构
完全重写右侧 60px 的 `div` 内容，废弃之前的“上下对齐图表”的逻辑，改为独立的“三层楼”逻辑。

```tsx
<div className="w-[60px] flex flex-col ...">
   {/* A. Price */}
   <div className={`flex-1 flex items-center justify-center ${flashClass}`}>...</div>
   
   {/* B. Bid-Ask Gauge */}
   <div className="flex-[2] flex flex-col items-center justify-center border-t border-b border-slate-700/30 py-1">
      <span className="text-[8px] text-green-400 mb-0.5">{ask}</span>
      <div className="w-1.5 flex-1 bg-slate-800 rounded-full overflow-hidden relative">...</div>
      <span className="text-[8px] text-red-400 mt-0.5">{bid}</span>
   </div>
   
   {/* C. Tick Vol */}
   <div className="flex-1 flex flex-col items-center justify-center">...</div>
</div>
```

### Step 3: 状态管理
引入 `usePrevious` hook 来记录上一次的价格，用于触发顶层的背景闪烁。

## 4. 交付
修改 `SentimentTrend.tsx`，严格落实上述 UI。

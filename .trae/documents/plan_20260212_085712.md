# 标准 30分钟 K线分桶方案

你是对的，标准的金融时间序列（如 Wind/同花顺）通常将 09:15 的集合竞价数据归入第一根 30分钟 K线，而 15:00 的收盘竞价归入最后一根 K线。

每天 4 小时交易时间 = 240 分钟 = 8 根 30分钟 K线。

## 修正方案
我将修改后端的聚合逻辑，强制使用以下 8 个标准时间桶（End Time Labeling），以符合国内看盘软件习惯：

1.  **10:00** (包含 09:15 - 10:00 的所有数据，即集合竞价 + 开盘半小时)
2.  **10:30** (10:00 - 10:30)
3.  **11:00** (10:30 - 11:00)
4.  **11:30** (11:00 - 11:30)
5.  **13:30** (13:00 - 13:30)
6.  **14:00** (13:30 - 14:00)
7.  **14:30** (14:00 - 14:30)
8.  **15:00** (14:30 - 15:00+，包含收盘竞价)

## 实施步骤
1.  **修改聚合算法**: 在 `backend/app/services/analysis.py` 中，不再使用 Pandas 默认的 `resample`，而是使用自定义的分桶映射逻辑，将 09:15-10:00 强制归一化为 10:00，14:30-15:00+ 强制归一化为 15:00。
2.  **重新清洗数据**: 再次运行 `backfill_history.py`，覆盖之前的历史数据。
3.  **前端调整**: 无需修改，前端展示的是时间字符串，后端调整后前端会自动显示为 10:00, 10:30... 15:00。

这样每天将严格只有 8 个数据点，且不会出现 09:00 或 15:05 这种奇怪的时间点。

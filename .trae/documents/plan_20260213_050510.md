# V3.0 最终优化实施方案

## 1. 需求分析
1.  **剔除午休时间**：需过滤掉 `11:30` 到 `13:00` 之间的数据点。
2.  **实现“实时区” (Active Zone)**：
    *   **视觉**：右侧预留约 5% 宽度，用于展示当前分钟的实时状态。
    *   **逻辑**：历史曲线（左侧）在上一分钟结束时停止。当前分钟的数据仅通过一个“跳动的呼吸点”展示。
    *   **断点**：历史线与呼吸点之间应有断开（Gap），体现“未归档”状态。

## 2. 实施步骤

### A. 后端改造 (`backend/app/db/crud.py`)
*   **过滤午休**: 在 `get_sentiment_history_aggregated` 函数中增加逻辑，跳过 `11:30` 至 `13:00` 的数据聚合。

### B. 前端改造 (`src/components/dashboard/SentimentTrend.tsx`)
*   **实时区与断点实现**:
    1.  **数据构造**:
        *   `chartData` = `[...历史数据, 占位数据]`。
        *   `占位数据`：使用 `liveData` 的时间戳，但将 `cvd` 设为 `null`。
        *   **效果**: `AreaChart` 会自动扩展 X 轴以包含当前时间（实现右侧留白），但因为 `cvd` 为空，折线图不会画到这个点（实现断点）。
    2.  **呼吸点 (ReferenceDot)**:
        *   显式指定 `x={liveData.timestamp}` 和 `y={liveData.cvd}`。
        *   这样点会悬浮在最新的时间坐标上，与左侧历史线分离。
*   **前端双重过滤**:
    *   在 `useMemo` 中再次过滤 `11:30-13:00`，确保显示准确。

### C. 执行动作
1.  修改 `backend/app/db/crud.py`。
2.  修改 `src/components/dashboard/SentimentTrend.tsx`。
3.  重启后端服务。

此方案完美契合“历史归档（线）+ 实时跳动（点）”的视觉需求，且通过 `null` 值实现了物理上的线条阻断。

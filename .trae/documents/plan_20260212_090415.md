# 数据安全性确认与清理方案

## 1. 核心确认：数据不会丢失
您提到的担忧非常合理，但我已确认：**删除 `history_30m` 不会影响原始数据**。

*   **原始数据 (`trade_ticks`)**: 这是您今天盘中通过实时接口拉取并存入 SQLite 的最底层数据。这部分数据**完全保留**，不会被删除。
*   **衍生数据 (`history_30m`)**: 这是我们刚才计算出来的 30分钟 K 线数据。删除它只是删除了“计算结果”，我们随时可以用原始数据重新算一遍。
*   **Backfill 机制**: `backfill_history.py` 脚本读取的是本地的 `trade_ticks`，**不依赖**外部网络接口（Sina/腾讯）。只要本地库里有今天的 Tick，就能无限次重算。

## 2. 为什么必须清理？
目前的 `history_30m` 表里混杂了两套逻辑的数据：
*   旧逻辑（按开始时间）：`09:00`, `09:30`, `13:00`...
*   新逻辑（按结束时间）：`10:00`, `10:30`, `13:30`...

如果不清空，旧数据会一直赖在表里，导致图表上同时出现 "09:00" 和 "10:00"，让时间轴看起来非常混乱。

## 3. 执行步骤
1.  **清空衍生表**: 执行 SQL `DELETE FROM history_30m`（仅清空计算结果）。
2.  **重新计算**: 运行 `backfill_history.py`，基于本地原始 Tick 重新生成标准的 8 根 K 线。
3.  **结果**: 数据库里将只有 `10:00`, `10:30` ... `15:00` 这 8 条干净的数据。

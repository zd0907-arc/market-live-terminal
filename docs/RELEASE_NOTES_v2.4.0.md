# 版本更新说明 v2.4.0

**发布日期**: 2026-02-12
**版本号**: v2.4.0

## 核心变更

### 1. ⚡️ 性能与架构升级
*   **后端实时聚合 (Server-Side Aggregation)**: 
    *   将原前端承担的数万条逐笔数据计算逻辑迁移至后端 Python 服务。
    *   新增 `/api/realtime/dashboard` 接口，仅返回分钟级趋势数据和最新 Top 50 逐笔明细。
    *   **效果**: 页面加载速度提升 100倍+ (数据传输量从 MB 级降至 KB 级)，彻底解决长时间交易后的前端卡顿问题。

### 2. ⚙️ 全局动态配置
*   **资金阈值热更新**:
    *   新增系统级配置入口（页面右上角 Header 区域）。
    *   支持动态调整“主力大单阈值”（默认 50万）和“超大单阈值”（默认 100万）。
    *   **联动效果**: 修改配置后，实时监控视图和历史复盘视图均会自动重新计算并刷新，无需重启服务。

### 3. 🐛 数据清洗与准确性修复
*   **收盘数据熔断**:
    *   后端采集器 (`collector.py`) 增加硬性时间限制，**15:05:00** 后强制停止数据录入。
    *   数据查询层自动过滤 `15:00:05` 之后的异常时间戳，修复了 K 线图尾盘出现“幽灵数据”的问题。
    *   重构了分钟线对齐逻辑，确保 10:00, 10:30 等关键刻度数据归类准确。

### 4. 🛠 其他改进
*   **数据库优化**: 为 `trade_ticks` 表的查询字段添加了更高效的索引策略。
*   **代码清理**: 移除了前端冗余的 `calculateCapitalFlow` 等计算逻辑，统一由后端 `analysis.py` 负责核心算法，保证了历史回测与实时监控逻辑的一致性。

---

## 升级指南
1.  **后端**: 重启后端服务以应用新的 API 路由和数据库 Schema 更新。
    ```bash
    python3 -m backend.app.main
    ```
2.  **前端**: 刷新页面即可加载新版 UI。

## 已知问题
*   暂无。
